# CURRENTLY PATCHED WITH:
#	Stellaris: Evolved (SE)
#	Ethics and Civics: Bug Branch (BB)
#	Ethics and Civics Alternative - Redux (AR)
#	Ethics and Civics Classic (EC)
#	Expanded Traits, Civics, Pops, and More (ET)
#	Gigastructural Engineering & More (GE)
#	Organic Zealots (OZ)
#
#	If you have any other mods that you want to become compatible with Empires Expanded,
#	please let me know!
#
#	NOTE: Forks of Ethics and Civics will likely work also, unless they specifically changed the IDs
#	of some civics, such as Bug Branch as shown above.

## OVERWRITTEN POLICIES ##

orbital_bombardment = {

	potential = {
		if = { #GE
			limit = {
				NOT = { has_global_flag = gigastructures_enabled }
			}
			OR = {
				is_country_type = default
				is_country_type = vol
			}
		}
		else = {
			OR = {
				ehof_default_country = yes
				is_country_type = vol
			}
		}
	}

	option = {
		name = "orbital_bombardment_selective"
		policy_flags = {
			orbital_bombardment_selective
		}

		AI_weight = {
			modifier = {
				factor = 0
				NOR = {
					has_ethic = "ethic_pacifist"
					has_ethic = "ethic_fanatic_pacifist"
					is_ecocentric = yes #BB
				}
				NOT = {
					is_galactic_community_member = yes
					OR = {
						is_active_resolution = "resolution_rulesofwar_independent_tribunals"
						is_active_resolution = "resolution_rulesofwar_last_resort_doctrine"
						is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
					}
				}
			}
		}
	}
	option = {
		name = "orbital_bombardment_indiscriminate"

		in_breach_of = {
			{
				key = resolution_rulesofwar_independent_tribunals
			}
		}

		policy_flags = {
			orbital_bombardment_indiscriminate
		}
		modifier = {}

		valid = {
			NOR = {
				has_ethic = "ethic_pacifist"
				has_ethic = "ethic_fanatic_pacifist"
				has_valid_civic = "civic_tec_peacekeepers" #SE
				is_bugged_interventionalist = yes #BB
				has_valid_civic = "civic_xeno_militarist" #AR
			}
		}
		AI_weight = {
			modifier = {
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
					is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
				}
			}
		}
	}
	option = {
		name = "orbital_bombardment_armageddon"

		in_breach_of = {
			{
				key = resolution_rulesofwar_independent_tribunals
			}
		}

		potential = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_machine_terminator
				has_valid_civic = civic_bringers_of_death
				has_valid_civic = civic_machine_destructive_programming
				is_valid_organic_zealots = yes
			}
		}

		policy_flags = {
			orbital_bombardment_armageddon
		}
		modifier = {}

		AI_weight = {
			modifier = {
				factor = 10
				OR = {
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_machine_terminator
					has_valid_civic = civic_bringers_of_death
				}
			}
			modifier = {
				factor = 10
				has_ascension_perk = ap_become_the_crisis
			}
		}
	}
	#GE
	option = {
		name = "orbital_bombardment_redtoxin"
		in_breach_of = {
			{
				key = resolution_rulesofwar_independent_tribunals
			}
		}
		potential = {
			has_global_flag = gigastructures_enabled
			OR = {
				ehof_default_country = yes
				is_country_type = vol
			}
		}
		prerequisites = {
			tech_scourge_deployment
		}
		policy_flags = {
			orbital_bombardment_redtoxin
		}
		valid = {
			NOR = {
				has_ethic = "ethic_pacifist"
				has_ethic = "ethic_fanatic_pacifist"
			}
		}
		AI_weight = {
			modifier = {
				factor = 10
				OR = {
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_machine_terminator
				}
			}
			modifier = {
				factor = 10
				has_ascension_perk = ap_become_the_crisis
			}
		}
	}
}

economic_policy = {
	potential = {
		NOT = { has_ethic = ethic_gestalt_consciousness }
	}

	option = { #EMEX
		name = "economic_policy_civilian"

		modifier = {
			planet_jobs_consumer_goods_produces_mult = 0.25
			planet_jobs_alloys_produces_mult = -0.25
		}
		
		valid = {
			NOR = {
				has_valid_civic = civic_war_economy
				has_valid_civic = civic_war_factories
				has_valid_civic = "civic_tec_military_council" #SE
				has_valid_civic = "civic_bugged_war_council" #BB
				has_valid_civic = "civic_military_junta" #AR
			}
		}
		
		#BB
		policy_flags = {
			economic_policy_civilian
		}
		
		#ET
		AI_weight = {
			weight = 0
			modifier = {
				weight = 15
				is_at_war = no
				OR = {
					has_monthly_income = {
						resource = consumer_goods
						value < 25
					}
					AND = {
						has_civic = civic_megastore
						has_monthly_income = {
							resource = alloys
							value > 100
						}
					}
				}
				OR = {
					resource_stockpile_compare = {
						resource = consumer_goods
						value < 5000
					}
					AND = {
						has_civic = civic_megastore
						resource_stockpile_compare = {
							resource = consumer_goods
							value < 10000
						}
					}
				}
			}
			modifier = {
				weight = 2
				is_at_war = no
				OR = {
					is_pacifist = yes
					has_ai_personality = open_hive_mind
					has_ai_personality = open_machine_intelligence
					has_monthly_income = { resource = alloys value > 20 }
				}
			}
		}
	}

	option = {
		name = "economic_policy_balanced"

		modifier = {}
		
		#BB
		policy_flags = {
			economic_policy_balanced
		}
		
		AI_weight = {
			factor = 1
			modifier = {
				factor = 10
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
			}
		}
	}

	option = {
		name = "economic_policy_military"

		in_breach_of = {
			{
				key = resolution_rulesofwar_demobilization_initiative
			}
		}

		modifier = {
			planet_jobs_consumer_goods_produces_mult = -0.25
			planet_jobs_alloys_produces_mult = 0.25
		}

		valid = {
			NOR = {
				has_valid_civic = civic_peaceful_society
				has_valid_civic = "civic_tec_utopian_democracy" #SE
				has_valid_civic = "civic_bugged_utopian_democracy" #BB
				has_valid_civic = "civic_peaceful_republic" #AR
			}
            NOT = {
				AND = {
					has_valid_civic = civic_war_economy
					has_valid_civic = civic_warmongers
				}
			}
		}

        potential = { # emex
			NOT = {
				AND = {
					has_valid_civic = civic_war_economy
					has_valid_civic = civic_warmongers
				}
			}
		}
		
		policy_flags = {
			economic_policy_military
		}

		AI_weight = { #ET
			weight = 0
			modifier = {
				weight = 20
				or = {
					is_at_war = yes
					is_authoritarian = yes
				}
				NOT = { has_civic = civic_megastore } # other benefits from other policy options
				resource_stockpile_compare = {
					resource = consumer_goods
					value > 2500
				}
				resource_stockpile_compare = {
					resource = alloys
					value < 10000
				}
				has_monthly_income = {
					resource = alloys
					value < 100
				}
			}
			modifier = {
				weight = 20
				has_ascension_perk = ap_become_the_crisis
				has_monthly_income = { resource = consumer_goods value > 20 }
			}
			modifier = {
				factor = 0.1
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
			}
		}
	}

    # emex
    option = {
		name = "economic_policy_military_harbingers_emex"

		in_breach_of = {
			{
				key = resolution_rulesofwar_demobilization_initiative
			}
		}

		modifier = {
			planet_jobs_consumer_goods_produces_mult = -0.25
			planet_jobs_alloys_produces_mult = 0.25
			planet_metallurgists_upkeep_mult = -0.10
			country_power_projection_influence_produces_mult = 0.10
		}

		potential = {
			has_valid_civic = civic_war_economy
			has_valid_civic = civic_warmongers
		}
		
		policy_flags = {
			economic_policy_military
		}

		AI_weight = {
			weight = 0
			modifier = {
				weight = 20
				or = {
					is_at_war = yes
					is_authoritarian = yes
				}
				resource_stockpile_compare = {
					resource = consumer_goods
					value > 2500
				}
				resource_stockpile_compare = {
					resource = alloys
					value < 10000
				}
				has_monthly_income = {
					resource = alloys
					value < 100
				}
			}
			modifier = {
				weight = 20
				has_ascension_perk = ap_become_the_crisis
				has_monthly_income = { resource = consumer_goods value > 20 }
			}
			modifier = {
				factor = 0.1
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
			}
		}
	}
}

# This is a biggie...
# Thanks for removing all the trade policies from BB I love you Bug Behemoth
trade_policy = {
    potential = {
        NOT = {
            has_ethic = ethic_gestalt_consciousness
        }
    }
    option = {
        name = "trade_policy_default"
        policy_flags = {
            trade_policy_default
            trade_conversion_default
        }
        potential = {
            OR = {
                NOT = {
                    has_global_flag = expanded_pops_active
                }
                OR = {
                    has_federation = no
                    AND = {
                        has_federation = yes
                        federation = {
                            NOT = {
                                has_federation_perk = trade_federation_passive
                            }
                        }
                    }
                }
            }
        }
        valid = {
            NOR = {
                has_policy_flag = "economic_stance_planned"
                has_ethic = "ethic_fanatic_socialism"
            }
        }
        AI_weight = {
            factor = 0
            modifier = {
                weight = 2
                has_monthly_income = {
                    resource = energy
                    value < 25
                }
            }
        }
    }
    option = {
        name = "trade_policy_mutual_aid"
        potential = {
            is_worker_coop_empire = yes
        }
        policy_flags = {
            trade_conversion_mutual_aid
        }
        modifier = {
        }
        AI_weight = {
            factor = 1000
        }
    }
    option = {
        name = "trade_policy_consumer_goods"
        potential = {
            OR = {
                has_federation = no
                AND = {
                    has_federation = yes
                    federation = {
                        NOT = {
                            has_federation_perk = trade_federation_passive
                        }
                    }
                }
            }
            has_tradition = tr_mercantile_adaptive_economic_policies
        }
        policy_flags = {
            trade_conversion_consumer_goods
        }
        valid = {
            NOR = {
                has_policy_flag = "economic_stance_planned"
                has_ethic = "ethic_fanatic_socialism"
            }
        }
        modifier = {
        }
        AI_weight = {
            factor = 1
        }
    }
    option = {
        name = "trade_policy_unity"
        potential = {
            OR = {
                has_federation = no
                AND = {
                    has_federation = yes
                    federation = {
                        NOR = {
                            has_federation_perk = trade_federation_passive
                            has_federation_perk = unity_trade_1
                        }
                    }
                }
            }
            has_tradition = tr_mercantile_adaptive_economic_policies
        }
        policy_flags = {
            trade_conversion_unity
        }
        valid = {
            NOR = {
                has_policy_flag = "economic_stance_market"
                has_policy_flag = "economic_stance_planned"
            }
        }
        modifier = {
        }
        AI_weight = {
            weight = 0
            modifier = {
                weight = 2
                is_at_war = no
                has_monthly_income = {
                    resource = consumer_goods
                    value > 50
                }
            }
        }
    }
    option = {
        name = "trade_policy_research"
        potential = {
            OR = {
                has_civic = civic_public_informants
                has_civic = civic_corp_public_informants
            }
        }
        policy_flags = {
            trade_policy_research
        }
        modifier = {
        }
        AI_weight = {
            weight = 5
            modifier = {
                weight = 2
                years_passed < 10
            }
            modifier = {
                weight = 3
                is_ai = no
            }
        }
    }
    option = {
        name = "trade_policy_mineral_corp"
        potential = {
            has_global_flag = expanded_pops_active
            OR = {
                is_megacorp = yes
                has_civic = civic_corporate_dominion
            }
            OR = {
                has_federation = no
                AND = {
                    has_federation = yes
                    federation = {
                        NOT = {
                            has_federation_perk = trade_federation_passive
                        }
                    }
                }
            }
        }
        policy_flags = {
            trade_conversion_mineral_corp
        }
        modifier = {
        }
        AI_weight = {
            weight = 0
            modifier = {
                weight = 3
                is_at_war = no
                has_monthly_income = {
                    resource = minerals
                    value < 25
                }
            }
        }
    }
    option = {
        name = "trade_policy_food_corp"
        potential = {
            has_global_flag = expanded_pops_active
            OR = {
                is_megacorp = yes
                has_civic = civic_corporate_dominion
            }
            OR = {
                has_federation = no
                AND = {
                    has_federation = yes
                    federation = {
                        NOT = {
                            has_federation_perk = trade_federation_passive
                        }
                    }
                }
            }
        }
        policy_flags = {
            trade_conversion_food_corp
        }
        modifier = {
        }
        AI_weight = {
            weight = 0
            modifier = {
                weight = 3
                is_at_war = no
                has_monthly_income = {
                    resource = food
                    value < 25
                }
            }
        }
    }
    option = {
        name = "trade_policy_trade_league"
        potential = {
            has_global_flag = expanded_pops_active
            has_federation = yes
            federation = {
                has_federation_perk = trade_federation_passive
            }
        }
        policy_flags = {
            trade_conversion_trade_league
        }
        modifier = {
        }
        AI_weight = {
            factor = 1000
            modifier = {
                weight = 3
                is_ai = no
            }
        }
    }
    option = {
        name = "trade_policy_trade_league_raw"
        potential = {
            has_global_flag = expanded_pops_active
            has_federation = yes
            federation = {
                has_federation_perk = trade_federation_passive
            }
        }
        policy_flags = {
            trade_conversion_trade_league_raw
        }
        modifier = {
        }
        AI_weight = {
            weight = 0
            modifier = {
                weight = 2000
                OR = {
                    AND = {
                        country_uses_food = yes
                        has_monthly_income = {
                            resource = food
                            value < 25
                        }
                    }
                    has_monthly_income = {
                        resource = minerals
                        value < 25
                    }
                }
            }
        }
    }
    option = {
        name = "trade_policy_trade_league_academic"
        potential = {
            has_federation = yes
            federation = {
                has_federation_perk = trade_federation_passive
            }
            OR = {
                has_civic = civic_public_informants
                has_civic = civic_corp_public_informants
            }
        }
        policy_flags = {
            trade_conversion_trade_league_academic
        }
        modifier = {
        }
        AI_weight = {
            weight = 2500
        }
    }
    option = {
        name = "trade_policy_trade_league"
        potential = {
            has_federation = yes
            federation = {
                has_federation_perk = trade_federation_passive
            }
            NOR = {
                has_global_flag = bug_branch_active
                has_global_flag = expanded_pops_active
            }
        }
        policy_flags = {
            trade_conversion_trade_league
        }
        modifier = {
        }
        AI_weight = {
            factor = 100
        }
    }
    option = {
        name = "trade_policy_holy_covenant"
        potential = {
            has_federation = yes
            federation = {
                has_federation_perk = unity_trade_1
            }
        }
        policy_flags = {
            trade_conversion_holy_covenant
        }
        modifier = {
        }
        AI_weight = {
            factor = 1000
        }
    }
	option = {
		name = "trade_policy_mutual_aid"
		potential = {
			is_worker_coop_empire = yes
		}

		policy_flags = {
			trade_conversion_mutual_aid
		}

		modifier = {
		}

		AI_weight = {
			factor = 1000
		}
	}
    option = { #EMEX
        name = "trade_policy_technocorp"
        potential = {
            has_valid_civic = civic_technocorp
        }
        policy_flags = {
            trade_conversion_technocorp
        }
        modifier = {
        }
        AI_weight = {
            factor = 100
        }
    }
    option = { #EMEX
        name = "trade_policy_technocorp_tl"
        potential = {
            has_valid_civic = civic_technocorp
            has_federation = yes
            federation = {
                has_federation_perk = trade_federation_passive
            }
        }
        policy_flags = {
            trade_conversion_technocorp_tl
        }
        modifier = {
        }
        AI_weight = {
            factor = 1100
        }
    }
    option = { #EMEX
		name = "emex_trade_policy_extortion"
		potential = {
			has_valid_civic = civic_anarcho_tyranny_v2
		}

		policy_flags = {
			emex_trade_conversion_extortion
		}

		modifier = {
		}

		AI_weight = {
			factor = 500
		}
	}
    option = { #EMEX
		name = "emex_trade_policy_monopsony_food"
		potential = {
			has_valid_civic = civic_emex_interplanetary_monopsony
			has_policy_flag = emex_monopsonic_exploitation_food
		}

		policy_flags = {
			emex_trade_conversion_monopsony
		}

		modifier = {
		}

		AI_weight = {
			factor = 100
		}
	}
	option = { #EMEX
		name = "emex_trade_policy_monopsony_minerals"
		potential = {
			has_valid_civic = civic_emex_interplanetary_monopsony
			has_policy_flag = emex_monopsonic_exploitation_minerals
		}

		policy_flags = {
			emex_trade_conversion_monopsony
		}

		modifier = {
		}

		AI_weight = {
			factor = 100
		}
	}
    option = {
        name = "trade_policy_social"
        potential = {
            has_global_flag = stellarisevolved
        }
        policy_flags = {
            trade_conversion_social
        }
        valid = {
            tec_is_default_country = yes
            OR = {
                has_ethic = "ethic_socialism"
                has_ethic = "ethic_fanatic_socialism"
            }
        }
        modifier = {
            planet_colony_development_speed_mult = 0.25
        }
        AI_weight = {
            factor = 0
        }
    }
    option = {
        name = "trade_policy_infrastructure"
        potential = {
            has_global_flag = stellarisevolved
        }
        policy_flags = {
            trade_conversion_infrastructure
        }
        modifier = {
            planet_building_build_speed_mult = 0.2
            starbase_shipyard_build_speed_mult = 0.1
        }
        valid = {
            OR = {
                tec_is_trade_gestalt = yes
                tec_is_default_country = yes
            }
        }
        AI_weight = {
            factor = 0
        }
    }
    option = {
        name = "trade_policy_innovation"
        potential = {
            has_global_flag = stellarisevolved
            OR = {
                OR = {
                    custom_tooltip = "civic_tooltip_materialist"
                    has_ethic = ethic_materialist
                    has_ethic = ethic_fanatic_materialist
                    has_ethic = ethic_gestalt_consciousness
                }
            }
        }
        policy_flags = {
            trade_conversion_innovation
        }
        valid = {
            tec_is_default_country = yes
            OR = {
                custom_tooltip = "civic_tooltip_materialist"
                has_ethic = ethic_materialist
                has_ethic = ethic_fanatic_materialist
                has_ethic = ethic_gestalt_consciousness
            }
            NOR = {
                has_valid_civic = civic_tec_immutable_hierarchy
            }
        }
        modifier = {
        }
        AI_weight = {
            factor = 0
        }
    }
    option = {
        name = "trade_policy_food"
        potential = {
            has_global_flag = stellarisevolved
        }
        policy_flags = {
            trade_conversion_food
        }
        modifier = {
        }
        valid = {
            tec_is_default_country = yes
            OR = {
                OR = {
                    custom_tooltip = "civic_tooltip_green"
                    has_ethic = ethic_green
                    has_ethic = ethic_fanatic_green
                    has_ethic = ethic_gestalt_preservation
                }
            }
        }
        AI_weight = {
            factor = 0
        }
    }
    option = {
        name = "trade_policy_mining"
        potential = {
            has_global_flag = stellarisevolved
        }
        policy_flags = {
            trade_conversion_mining
        }
        modifier = {
        }
        valid = {
            tec_is_default_country = yes
            OR = {
                custom_tooltip = "civic_tooltip_industrial"
                has_ethic = ethic_industrial
                has_ethic = ethic_fanatic_industrial
                has_ethic = ethic_gestalt_disregard
            }
        }
        AI_weight = {
            factor = 0
        }
    }
    option = {
        name = "trade_policy_growth_dev"
        policy_flags = {
            trade_conversion_growth_dev
        }
        potential = {
            has_global_flag = cultural_overhaul_active
            NOR = {
                has_global_flag = bug_branch_active
                has_global_flag = bug_branch_active
            }
        }
        valid = {
            NOR = {
                has_policy_flag = "economic_stance_market"
                has_ethic = "ethic_fanatic_capitalism"
            }
        }
        modifier = {
        }
        AI_weight = {
            factor = 0
        }
    }
    option = {
        name = "trade_policy_development"
        policy_flags = {
            trade_conversion_development
        }
        potential = {
            has_global_flag = cultural_overhaul_active
            NOR = {
                has_global_flag = bug_branch_active
                has_global_flag = bug_branch_active
            }
        }
        modifier = {
            planet_building_build_speed_mult = 0.15
            starbase_shipyard_build_speed_mult = 0.15
            planet_colony_development_speed_mult = 0.15
        }
        valid = {
            NOR = {
                has_policy_flag = "economic_stance_market"
                has_ethic = "ethic_fanatic_capitalism"
            }
        }
        AI_weight = {
            factor = 0
        }
    }
    option = {
        name = "trade_policy_innovation"
        policy_flags = {
            trade_conversion_innovation
        }
        potential = {
            has_global_flag = cultural_overhaul_active
            NOR = {
                has_global_flag = bug_branch_active
                has_global_flag = bug_branch_active
            }
        }
        valid = {
            or = {
                has_technology = tech_innovations
            }
            NOR = {
                has_valid_civic = civic_ultimate_collective
            }
            NOR = {
                has_policy_flag = "economic_stance_market"
                has_policy_flag = "economic_stance_planned"
            }
        }
        modifier = {
        }
        AI_weight = {
            factor = 0
        }
    }
    option = {
        name = "trade_policy_growth"
        policy_flags = {
            trade_conversion_growth
        }
        potential = {
            has_global_flag = cultural_overhaul_active
            NOR = {
                has_global_flag = bug_branch_active
                has_global_flag = bug_branch_active
            }
        }
        modifier = {
        }
        valid = {
            or = {
                has_technology = tech_agri_consortium
            }
            NOR = {
                has_policy_flag = "economic_stance_market"
            }
        }
        AI_weight = {
            factor = 0
        }
    }
    option = {
        name = "trade_policy_mining"
        policy_flags = {
            trade_conversion_mining
        }
        potential = {
            has_global_flag = cultural_overhaul_active
            NOR = {
                has_global_flag = bug_branch_active
                has_global_flag = bug_branch_active
            }
        }
        modifier = {
        }
        valid = {
            or = {
                has_technology = tech_mining_consortium
            }
            NOR = {
                has_policy_flag = "economic_stance_market"
            }
        }
        AI_weight = {
            factor = 0
        }
    }
}

artificial_intelligence_policy = {
    potential = {
        NOT = {
            has_ethic = ethic_gestalt_consciousness
        }
        OR = {
            is_valid_organic_zealots = yes
            can_set_ai_policy = yes
            has_country_flag = synthetic_empire
            is_bugged_machine_cult = yes
        }
    }
    option = {
        name = "ai_outlawed"
        valid = {
            OR = {
                NOR = {
                    has_ethic = "ethic_materialist"
                    has_ethic = "ethic_fanatic_materialist"
                    custom_tooltip = {
                        success_text = is_a_synthetic_empire
                        has_country_flag = synthetic_empire
                    }
                    is_machine_cult_emex = yes
                    has_valid_civic = civic_machine_cult
                    tec_is_robot_lover_spiritualist = yes
                    AND = {
                        is_materialist = yes
                        NOT = {
                            has_country_flag = tec_hates_robots
                        }
                    }
                    is_bugged_machine_cult = yes
                }
                is_valid_organic_zealots = yes
                AND = {
                    is_subject = yes
                    overlord = {
                        is_valid_organic_zealots = yes
                    }
                }
                has_country_flag = lost_robot_policy_war
            }
        }
        policy_flags = {
            ai_outlawed
        }
        in_breach_of = {
             {
                key = resolution_galacticstudies_advanced_xenostudies
            }
             {
                key = resolution_galacticstudies_ethical_guideline_refactoring
            }
             {
                key = resolution_galacticstudies_extradimensional_experimentation
            }
        }
        AI_weight = {
            modifier = {
                factor = 0
                OR = {
                    has_ethic = "ethic_materialist"
                    has_ethic = "ethic_fanatic_materialist"
                    has_origin = origin_mechanists
                }
            }
            modifier = {
                factor = 0
                is_machine_or_nihil_cult_emex = yes
            }
            modifier = {
                factor = 5
                OR = {
                    has_ethic = "ethic_spiritualist"
                    has_ethic = "ethic_fanatic_spiritualist"
                    NOT = {
                        tec_is_robot_lover_spiritualist = yes
                    }
                }
            }
            modifier = {
                factor = 0.1
                has_valid_ai_personality = yes
                is_ai = yes
                is_galactic_community_member = yes
                OR = {
                    is_active_resolution = "resolution_galacticstudies_advanced_xenostudies"
                    is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
                    is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
                }
            }
            modifier = {
                factor = 0
                OR = {
                    is_robot_empire = yes
                    AND = {
                        is_materialist = yes
                        NOT = {
                            has_country_flag = lost_robot_policy_war
                        }
                    }
                }
            }
            modifier = {
                factor = 10
                is_robot_empire = no
                OR = {
                    has_country_flag = lost_robot_policy_war
                    is_valid_organic_zealots = yes
                    AND = {
                        is_subject = yes
                        overlord = {
                            is_valid_organic_zealots = yes
                        }
                    }
                }
            }
        }
    }
    option = {
        name = "ai_servitude"
        in_breach_of = {
             {
                key = resolution_galacticstudies_advanced_xenostudies
            }
        }
        valid = {
            NOR = {
                custom_tooltip = {
                    fail_text = is_a_synthetic_empire_fail
                    has_country_flag = synthetic_empire
                }
                has_valid_civic = civic_machine_cult
                is_bugged_machine_cult = yes
                is_machine_cult_emex = yes
            }
            is_robot_empire = no
            is_not_restricted_by_organic_zealots_fail = yes
        }
        policy_flags = {
            ai_servitude
        }
        AI_weight = {
            modifier = {
                factor = 5
                has_valid_ai_personality = yes
                has_ai_personality_behaviour = robot_exploiter
            }
            modifier = {
                factor = 2
                has_valid_ai_personality = yes
                has_ai_personality_behaviour = robot_liberator
            }
            modifier = {
                factor = 0
                OR = {
                    has_ethic = "ethic_spiritualist"
                    has_ethic = "ethic_fanatic_spiritualist"
                }
                NOR = {
                    has_valid_civic = civic_tec_machine_cult
                    is_bugged_machine_cult = yes
                    is_machine_or_nihil_cult_emex = yes
                }
            }
            modifier = {
                factor = 0
                OR = {
                    has_ethic = "ethic_spiritualist"
                    has_ethic = "ethic_fanatic_spiritualist"
                }
                NOT = {
                    has_valid_ai_personality = yes
                    is_ai = yes
                    is_galactic_community_member = yes
                    OR = {
                        is_active_resolution = "resolution_galacticstudies_advanced_xenostudies"
                        is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
                        is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
                    }
                }
            }
        }
    }
    option = {
        name = "ai_full_rights"
        valid = {
            OR = {
                custom_tooltip = {
                    fail_text = is_a_synthetic_empire
                    OR = {
                        has_ascension_perk = ap_synthetic_evolution
                        tec_is_synthetic_empire = yes
                    }
                }
                NOR = {
                    has_ethic = "ethic_spiritualist"
                    has_ethic = "ethic_fanatic_spiritualist"
                }
                AND = {
                    OR = {
                        has_ethic = "ethic_spiritualist"
                        has_ethic = "ethic_fanatic_spiritualist"
                    }
                    is_machine_or_nihil_cult_emex = yes
                }
                AND = {
                    is_spiritualist = yes
                    OR = {
                        tec_is_robot_lover_spiritualist = yes
                    }
                }
                is_bugged_machine_cult = yes
                has_valid_civic = civic_machine_cult
            }
            NOR = {
                has_policy_flag = robots_outlawed
                has_country_flag = tec_hates_robots
            }
            is_not_restricted_by_organic_zealots_fail = yes
        }
        policy_flags = {
            ai_full_rights
        }
        in_breach_of = {
             {
                key = resolution_divinity_a_defined_purpose
            }
        }
        modifier = {
        }
        AI_weight = {
            modifier = {
                factor = 5
                has_ascension_perk = ap_the_flesh_is_weak
            }
            modifier = {
                factor = 0.5
                is_materialist = no
                NOR = {
                    is_synthetic_empire = yes
                    has_technology = tech_synthetic_workers
                }
            }
            modifier = {
                factor = 5
                has_valid_ai_personality = yes
                has_ai_personality_behaviour = robot_liberator
            }
            modifier = {
                factor = 0
                AND = {
                    OR = {
                        has_ethic = "ethic_spiritualist"
                        has_ethic = "ethic_fanatic_spiritualist"
                    }
                    NOT = {
                        is_machine_or_nihil_cult_emex = yes
                    }
                }
            }
            modifier = {
                factor = 0
                is_robot_empire = no
                OR = {
                    has_country_flag = lost_robot_policy_war
                    is_valid_organic_zealots = yes
                    AND = {
                        is_subject = yes
                        overlord = {
                            is_valid_organic_zealots = yes
                        }
                    }
                }
            }
        }
    }
    option = {
        name = "ai_worshipped"
        valid = {
            is_machine_cult_emex = yes
            NOT = {
                has_policy_flag = robots_outlawed
            }
        }
        policy_flags = {
            ai_full_rights
            ai_worshipped
        }
        modifier = {
            planet_pop_assembly_mult = 0.1
            planet_pops_robotics_upkeep_mult = 0.05
        }
        AI_weight = {
            modifier = {
                factor = 10
                always = yes
            }
        }
    }
}

robot_pop_policy = {
    potential = {
        OR = {
            NOT = {
                has_ethic = ethic_gestalt_consciousness
            }
            AND = {
                has_ethic = ethic_gestalt_consciousness
                has_technology = tech_robotic_workers
            }
        }
    }
    option = {
        name = "robot_pops_outlawed"
        valid = {
            NOR = {
                has_ethic = "ethic_materialist"
                has_ethic = "ethic_fanatic_materialist"
                is_bugged_machine_cult = yes
                is_machine_cult_emex = yes
                has_country_flag = synthetic_empire
                has_valid_civic = civic_tec_machine_cult
                has_valid_civic = civic_machine_cult
            }
            NOT = {
                has_policy_flag = ai_full_rights
            }
            OR = {
                is_materialist = no
                has_country_flag = tec_hates_robots
                custom_tooltip = {
                    text = lost_robot_policy_war
                    has_country_flag = lost_robot_policy_war
                }
                custom_tooltip = {
                    text = civic_tooltip_not_organic_zealots
                    is_valid_organic_zealots = yes
                }
                custom_tooltip = {
                    text = civic_tooltip_overlord_not_organic_zealots
                    is_subject = yes
                    overlord = {
                        is_valid_organic_zealots = yes
                    }
                }
            }
        }
        policy_flags = {
            robots_outlawed
        }
        on_enabled = {
            hidden_effect = {
                every_owned_species = {
                    limit = {
                        is_robotic_species = yes
                    }
                    set_citizenship_type = {
                        type = citizenship_purge
                        country = root
                    }
                }
            }
        }
        AI_weight = {
            factor = 1
            modifier = {
                factor = 10
                is_robot_empire = no
                OR = {
                    is_valid_organic_zealots = yes
                    has_country_flag = lost_robot_policy_war
                }
            }
            modifier = {
                factor = 0
                OR = {
                    has_ethic = "ethic_materialist"
                    has_ethic = "ethic_fanatic_materialist"
                    has_origin = origin_mechanists
                    NOT = {
                        has_country_flag = lost_robot_policy_war
                    }
                }
            }
            modifier = {
                factor = 10
                has_valid_ai_personality = yes
                NOR = {
                    has_ai_personality_behaviour = robot_exploiter
                    has_ai_personality_behaviour = robot_liberator
                }
            }
            modifier = {
                factor = 10
                AND = {
                    has_ethic = "ethic_fanatic_spiritualist"
                    is_bugged_machine_cult = no
                }
            }
        }
    }
    option = {
        name = "robot_pops_allowed"
        valid = {
            OR = {
                is_robot_empire = yes
                is_not_restricted_by_organic_zealots_fail = yes
            }
        }
        policy_flags = {
            robots_allowed
        }
        AI_weight = {
            factor = 2
            modifier = {
                factor = 0
                OR = {
                    is_valid_organic_zealots = yes
                    AND = {
                        has_country_flag = lost_robot_policy_war
                        is_robot_empire = no
                    }
                    has_ethic = "ethic_fanatic_spiritualist"
                    is_bugged_machine_cult = no
                }
            }
        }
    }
}
